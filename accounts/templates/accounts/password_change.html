{% extends 'base.html' %}
{% load form_tags %}

{% block content %}
<div class="container" style="max-width:500px; margin:40px auto;">
  <div class="card" style="padding:25px; border-radius:8px; background:#fff; box-shadow:0 2px 8px rgba(0,0,0,0.1);">

    <h2 style="text-align:center; margin-bottom:25px;">🔒 Change Password</h2>

    {% if form.non_field_errors %}
      <ul class="messages">
        {% for err in form.non_field_errors %}
          <li class="error">❗ {{ err }}</li>
        {% endfor %}
      </ul>
    {% endif %}

    {% if form.errors %}
      <p style="color:#e74c3c; font-weight:bold; margin-bottom:15px;">
        ⚠️ Please correct the errors below.
      </p>
    {% endif %}

    <form method="post" action="" style="display:flex; flex-direction:column; gap:15px;">
      {% csrf_token %}
      
      {{ form.old_password
         |label_with_icon:"🔑"|safe
         |add_class:"form-input"
         |add_placeholder:"Current password"
         |add_attr:"autofocus:autofocus,required:required"
      }}
      {{ form.old_password.errors }}

      {{ form.new_password1
         |label_with_icon:"🆕"|safe
         |add_class:"form-input"
         |add_placeholder:"New password"
         |add_attr:"required:required"
      }}
      {{ form.new_password1.errors }}

      {{ form.new_password2
         |label_with_icon:"🔁"|safe
         |add_class:"form-input"
         |add_placeholder:"Repeat new password"
         |add_attr:"required:required"
      }}
      {{ form.new_password2.errors }}

      <button type="submit" style="background:#007BFF; color:#fff; padding:10px; border:none; border-radius:4px; cursor:pointer;">
        ✅ Update Password
      </button>
    </form>

    <p style="margin-top:20px; text-align:center;">
      <a href="{% url 'accounts:user_profile' username=request.user.username %}" style="color:#007BFF;">
        ← Back to Profile
      </a>
    </p>
    
  </div>
</div>
{% endblock %}
