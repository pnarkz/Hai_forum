{% comment %}
Topic Card Component
Usage: {% include 'components/topic_card.html' with topic=topic %}
Props: topic (required)
{% endcomment %}

<div class="bg-white/90 backdrop-blur-sm rounded-xl border border-blue-100 p-6 card-shadow hover:shadow-lg transition-all duration-300 group">
  <!-- Header -->
  <div class="flex items-start justify-between mb-4">
    <div class="flex-1">
      <h3 class="text-lg font-semibold text-slate-800 mb-2 group-hover:text-blue-700 transition-colors">
        <a href="{% url 'topic_detail' topic.slug %}" class="hover:underline">
          {{ topic.title }}
        </a>
      </h3>

      <!-- Category & Tags -->
      <div class="flex items-center flex-wrap gap-2 mb-3">
        {% if topic.category %}
          <a href="{% url 'topics_by_category' topic.category.slug %}"
             class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-blue-100 to-sky-100 text-blue-700 border border-blue-200 hover:bg-blue-200 transition">
            <i class="fas fa-folder mr-1"></i>
            {{ topic.category.name }}
          </a>
        {% endif %}

        {% for tag in topic.tags.all %}
          <a href="{% url 'topics_by_tag' tag.slug %}" class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-600 hover:bg-slate-200 transition-colors">
            #{{ tag.name }}
          </a>
        {% endfor %}
      </div>

      <!-- Description/Preview -->
      {% if topic.description %}
        <p class="text-slate-600 text-sm line-clamp-2 mb-3">
          {{ topic.description|truncatewords:25 }}
        </p>
      {% endif %}
    </div>

    <!-- Status Badges -->
    <div class="flex flex-col items-end gap-2 ml-4">
      {% if topic.is_pinned %}
        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-bold bg-gradient-to-r from-amber-100 to-yellow-100 text-amber-700 border border-amber-200">
          <i class="fas fa-thumbtack mr-1"></i> Sabitlenmiş
        </span>
      {% endif %}
      {% if topic.is_closed %}
        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-bold bg-gradient-to-r from-red-100 to-rose-100 text-red-700 border border-red-200">
          <i class="fas fa-lock mr-1"></i> Kapalı
        </span>
      {% endif %}
      {% if topic.is_solved %}
        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-bold bg-gradient-to-r from-green-100 to-emerald-100 text-green-700 border border-green-200">
          <i class="fas fa-check-circle mr-1"></i> Çözüldü
        </span>
      {% endif %}
    </div>
  </div>

  <!-- Stats Row -->
  <div class="flex items-center justify-between text-sm text-slate-500 border-t border-slate-100 pt-4">
    <div class="flex items-center space-x-4">
      {% if topic.author %}
        <div class="flex items-center space-x-2">
          <div class="w-6 h-6 rounded-full gradient-bg text-white flex items-center justify-center text-xs font-semibold">
            {{ topic.author.username|first|upper }}
          </div>
          <span class="font-medium text-slate-700">{{ topic.author.username }}</span>
        </div>
      {% endif %}

      {% if topic.created_at %}
        <div class="flex items-center space-x-1">
          <i class="far fa-clock text-xs"></i>
          <span>{{ topic.created_at|timesince }} önce</span>
        </div>
      {% endif %}
    </div>

    <div class="flex items-center space-x-4">
      <div class="flex items-center space-x-1 text-blue-600">
        <i class="far fa-comments"></i>
        <span class="font-medium">{{ topic.comments.count|default:0 }}</span>
      </div>
      <div class="flex items-center space-x-1">
        <i class="far fa-eye"></i>
        <span class="font-medium">{{ topic.views|default:0 }}</span>
      </div>
      <div class="flex items-center space-x-1 text-rose-500">
        <i class="far fa-heart"></i>
        <span class="font-medium">{{ topic.likes.count|default:0 }}</span>
      </div>
    </div>
  </div>

  {% if topic.last_activity %}
    <div class="mt-3 pt-3 border-t border-slate-100">
      <div class="flex items-center justify-between text-xs text-slate-500">
        <span>Son aktivite:</span>
        <div class="flex items-center space-x-2">
          {% if topic.last_activity.user %}
            <div class="w-4 h-4 rounded-full gradient-bg text-white flex items-center justify-center text-xs">
              {{ topic.last_activity.user.username|first|upper }}
            </div>
            <span>{{ topic.last_activity.user.username }}</span>
          {% endif %}
          <span>{{ topic.last_activity.created_at|timesince }} önce</span>
        </div>
      </div>
    </div>
  {% endif %}
</div>

<style>
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
</style>
